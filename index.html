<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DefyBot AI | Consultant Hub</title>
    <link rel="icon" type="image/png" href="logo.png">
    <style>
        :root { --accent: #004ecc; --deep: #111111; --border: #e2e8f0; --sidebar-bg: #f0f4f9; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: white; height: 100vh; display: flex; overflow: hidden; color: var(--deep); }
        .sidebar { width: 280px; background: var(--sidebar-bg); border-right: 1px solid var(--border); padding: 30px 15px; display: flex; flex-direction: column; gap: 8px; flex-shrink: 0; }
        .logo-wrapper { width: 180px; height: 180px; margin: 0 auto; background: white; border-radius: 28px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 25px rgba(0,0,0,0.05); border: 1px solid var(--border); overflow: hidden; padding: 15px; }
        .logo-wrapper img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .nav-btn { background: transparent; color: #444746; border: none; padding: 14px 20px; text-align: left; cursor: pointer; border-radius: 100px; font-weight: 500; transition: 0.3s; display: flex; align-items: center; gap: 12px; }
        .nav-btn.active { background: #c2e7ff; color: #001d35; font-weight: 600; }
        .main { flex: 1; position: relative; background: white; display: flex; flex-direction: column; overflow: hidden; }
        .page { display: none; height: 100%; width: 100%; padding: 40px; overflow-y: auto; }
        .page.active { display: flex; flex-direction: column; }
        #chatDisplay { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; margin-bottom: 80px; }
        .msg { max-width: 85%; padding: 12px 18px; border-radius: 18px; font-size: 14px; line-height: 1.5; white-space: pre-wrap; }
        .user-msg { align-self: flex-end; background: var(--deep); color: white; border-bottom-right-radius: 2px; }
        .ai-msg { align-self: flex-start; background: #f0f4f9; border: 1px solid var(--border); border-bottom-left-radius: 2px; }
        .chat-input-container { position: absolute; bottom: 20px; left: 20px; right: 20px; display: flex; gap: 10px; background: white; }
        .submit-btn { background: var(--deep); color: white; border: none; padding: 16px; border-radius: 100px; cursor: pointer; font-weight: 600; width: 100%; }
        input, textarea { width: 100%; padding: 12px 16px; border: 1px solid var(--border); border-radius: 12px; outline: none; }
        #debugInfo { font-size: 10px; color: #666; margin-top: 5px; text-align: center; font-family: monospace; }
        .typing { font-style: italic; color: #999; font-size: 12px; margin-left: 20px; display: none; }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="logo-area" style="text-align:center; margin-bottom:30px;">
            <div class="logo-wrapper"><img src="logo.png" alt="Logo" onerror="this.src='https://cdn-icons-png.flaticon.com/512/4712/4712035.png'"></div>
            <h2 style="font-size:12px; letter-spacing:3px; margin-top:10px;">DEFYBOT</h2>
        </div>
        <button class="nav-btn active" onclick="showPage('upworkPage', this)">‚úçÔ∏è Strategy Engine</button>
        <button class="nav-btn" onclick="showPage('chatPage', this)">üí¨ Expert Chat</button>
        <div id="debugInfo">SYSTEM READY</div>
    </nav>

    <main class="main">
        <section id="upworkPage" class="page active">
            <div style="max-width:800px; margin:0 auto;">
                <h2 style="margin-bottom:20px;">Strategy Engine</h2>
                <input type="text" id="clientName" placeholder="Client Name" style="margin-bottom:15px;">
                <textarea id="jobPost" rows="8" placeholder="Paste Upwork Job Post Here..." style="margin-bottom:15px;"></textarea>
                <button class="submit-btn" onclick="runUpworkEngine()">Generate High-Ticket Proposal</button>
                <div id="proposalResult" style="margin-top:20px; padding:20px; background:#f8fbff; border:1px solid #c2e7ff; border-radius:15px; display:none; white-space:pre-wrap;"></div>
            </div>
        </section>

        <section id="chatPage" class="page">
            <div id="chatDisplay"><div class="msg ai-msg">DefyBot Online. How can I help with your project today?</div></div>
            <div id="typingIndicator" class="typing">AI is thinking...</div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Send a message..." onkeypress="if(event.key==='Enter') sendChatMessage()">
                <button class="submit-btn" style="width:120px;" onclick="sendChatMessage()">Send</button>
            </div>
        </section>
    </main>

    <script>// NEW KEY TEST
const API_KEY = "AIzaSyAhXuQg8GSKXY2tlUpKu_vL9IkXObPhZiA"; 
const MODEL = "gemini-1.5-flash"; // Try changing to "gemini-pro" if flash fails

async function callAI(messages) {
    const debug = document.getElementById('debugInfo');
    debug.innerText = "CONNECTING...";
    
    // API URL
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`;
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ contents: messages })
        });

        const data = await response.json();

        // THIS WILL SHOW YOU THE EXACT PROBLEM
        if (data.error) {
            console.error("FULL ERROR:", data.error);
            debug.innerText = "ERROR: " + data.error.message;
            return "‚ùå API Error: " + data.error.message + " (Check Console for details)";
        }

        debug.innerText = "ONLINE";
        return data.candidates[0].content.parts[0].text;

    } catch (e) {
        debug.innerText = "NETWORK FAILED";
        return "‚ùå Connection Failed. Are you online?";
    }
}
    </script>
</body>
</html>
